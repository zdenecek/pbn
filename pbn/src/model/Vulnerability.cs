using System;

namespace pbn.model;

/// Represents bridge board vulnerability.
public enum Vulnerability
{
    None,
    Ns,
    Ew,
    Both
}

/// Helper extension methods for <see cref="Vulnerability"/>.
public static class VulnerabilityHelpers 
{
    /// Convert string to vulnerability, case insensitive.
    public static Vulnerability FromString(string str)
    {
        return str.ToLower() switch
        {
            "ns" => Vulnerability.Ns,
            "ew" => Vulnerability.Ew,
            "none" => Vulnerability.None,
            "all" or "both" => Vulnerability.Both,
            _ => throw new ArgumentException($"Unknown vulnerability: {str}")
        };
    }

    /// Convert vulnerability to string. Both is "All".
    public static string ToString(this Vulnerability vulnerability)
    {
        return vulnerability switch
        {
            Vulnerability.Both => "All",
            Vulnerability.Ew => "EW",
            Vulnerability.None => "None",
            Vulnerability.Ns => "NS",
            _ => throw new ArgumentException($"Unknown vulnerability: {vulnerability}")
        };
    }
}