using System;

namespace pbn.model;

/// <summary>
///     Represents bridge board vulnerability.
/// </summary>
public enum Vulnerability
{
    None,
    Ns,
    Ew,
    Both
}

/// <summary>
///     Helper extension methods for <see cref="Vulnerability" />.
/// </summary>
public static class VulnerabilityHelpers
{
    /// <summary>
    ///     Convert string to vulnerability, case insensitive.
    /// </summary>
    public static Vulnerability FromString(string str)
    {
        return str.ToLower() switch
        {
            "ns" => Vulnerability.Ns,
            "ew" => Vulnerability.Ew,
            "none" => Vulnerability.None,
            "all" or "both" => Vulnerability.Both,
            _ => throw new ArgumentException($"Unknown vulnerability: {str}")
        };
    }

    /// <summary>
    ///     Convert vulnerability to string. Both is "All".
    /// </summary>
    public static string ToString(this Vulnerability vulnerability)
    {
        return vulnerability switch
        {
            Vulnerability.Both => "All",
            Vulnerability.Ew => "EW",
            Vulnerability.None => "None",
            Vulnerability.Ns => "NS",
            _ => throw new ArgumentException($"Unknown vulnerability: {vulnerability}")
        };
    }
}